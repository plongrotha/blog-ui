<div
  id="container"
  class="max-w-7xl mx-auto px-4 py-8 scroll-smooth md:scroll-auto"
>
  <!-- Create Blog Form -->
  <div class="bg-white rounded-xl shadow-md p-6 mb-10">
    <h2 class="text-2xl font-bold text-gray-800 mb-4 text-center">
      Create New Blog Post
    </h2>
    <form #blogForm="ngForm" class="space-y-5">
      <div class="">
        <label
          for="title"
          class="block text-sm cursor-pointer font-medium text-gray-700 mb-1"
        >
          Title
        </label>
        <input
          type="text"
          id="title"
          name="title"
          [(ngModel)]="blogObj.title"
          required
          placeholder="Enter blog title"
          class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none"
        />
      </div>

      <div class="">
        <label
          for="content"
          class="block cursor-pointer text-sm font-medium text-gray-700 mb-1"
        >
          Content
        </label>
        <textarea
          id="content"
          name="content"
          [(ngModel)]="blogObj.content"
          required
          rows="5"
          placeholder="Write your blog content here..."
          class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none resize-y"
        ></textarea>
      </div>

      <div class="flex flex-wrap gap-3 justify-center sm:justify-start">
        <button
          (click)="createBlog()"
          [disabled]="!blogForm.form.valid"
          class="px-6 py-2 cursor-pointer bg-blue-600 text-white font-medium rounded-lg hover:bg-blue-700 transition disabled:bg-gray-400 disabled:cursor-not-allowed"
        >
          Create Blog
        </button>
        <button
          type="button"
          (click)="resetForm()"
          class="px-6 py-2 bg-gray-200 cursor-pointer text-gray-700 font-medium rounded-lg hover:bg-gray-300 transition"
        >
          Reset
        </button>
      </div>
    </form>
  </div>
  <!-- Confirmation Dialog -->
  <dialog
    #confirmDialog
    id="confirmDialog"
    class="rounded-2xl p-6 w-80 shadow-xl backdrop:bg-black/50 backdrop:backdrop-blur-sm text-center top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 m-0"
  >
    <h2 class="text-lg font-semibold text-gray-800 mb-4">
      Are you sure you want to delete this blog?
    </h2>

    <div class="flex justify-center gap-3">
      <button
        type="button"
        (click)="closeDeleteDialog()"
        class="px-4 py-2 bg-gray-300 rounded-lg hover:bg-gray-400 w-24 text-gray-700"
      >
        Cancel
      </button>
      <button
        type="button"
        (click)="deleteBlogById()"
        class="px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 w-24"
      >
        Delete
      </button>
    </div>
  </dialog>

  <!-- No Blogs -->
  @if (blogs.length === 0) {
  <div class="text-center text-gray-500 text-lg">
    No blogs yet. Start by creating one above!
  </div>
  }

  <!-- Blog Grid -->
  <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
    <div
      *ngFor="let blog of blogs; trackByBlogId"
      class="bg-white rounded-xl shadow-md overflow-hidden hover:shadow-lg transition-shadow duration-300 p-6 flex flex-col justify-between"
    >
      <div>
        <div class="flex justify-between items-center">
          <h2 class="text-xl font-semibold text-gray-800 mb-2">
            {{ blog.title }}
          </h2>
          <div class="flex justify-center">
            <button (click)="openUpdateDialog(blog)" class="cursor-pointer">
              <svg
                class="w-6 h-6 text-gray-800 dark:text-blue-500"
                aria-hidden="true"
                xmlns="http://www.w3.org/2000/svg"
                width="24"
                height="24"
                fill="none"
                viewBox="0 0 24 24"
              >
                <path
                  stroke="currentColor"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="m14.304 4.844 2.852 2.852M7 7H4a1 1 0 0 0-1 1v10a1 1 0 0 0 1 1h11a1 1 0 0 0 1-1v-4.5m2.409-9.91a2.017 2.017 0 0 1 0 2.853l-6.844 6.844L8 14l.713-3.565 6.844-6.844a2.015 2.015 0 0 1 2.852 0Z"
                />
              </svg>
            </button>

            <button
              type="button"
              (click)="openDeleteDialog(blog.blogId)"
              class="cursor-pointer"
            >
              <svg
                class="w-6 h-6 text-gray-800 dark:text-red-500"
                aria-hidden="true"
                xmlns="http://www.w3.org/2000/svg"
                width="24"
                height="24"
                fill="none"
                viewBox="0 0 24 24"
              >
                <path
                  stroke="currentColor"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M5 7h14m-9 3v8m4-8v8M10 3h4a1 1 0 0 1 1 1v3H9V4a1 1 0 0 1 1-1ZM6 7h12v13a1 1 0 0 1-1 1H7a1 1 0 0 1-1-1V7Z"
                />
              </svg>
            </button>
          </div>
        </div>
        <p class="text-gray-600 mb-4 line-clamp-3">{{ blog.content }}</p>
      </div>

      <div class="mt-auto">
        <div class="text-xs text-gray-400 flex justify-between">
          <span>Created: {{ blog.createdAt | date : "shortDate" }}</span>
        </div>
      </div>
    </div>
  </div>
</div>

<div class="flex justify-end">
  <button
    *ngIf="scrollToTopBtn"
    (click)="scrollToTop()"
    class="go-to-top mr-3 bg-blue-500 cursor-pointer dark:bg-gray-900 dark:border-gray-700 transition-all rounded-3xl text-white"
  >
    <a class="flex items-center px-4 py-2">
      <svg
        class="w-6 h-6 text-red-800 dark:text-white"
        aria-hidden="true"
        xmlns="http://www.w3.org/2000/svg"
        width="24"
        height="24"
        fill="none"
        viewBox="0 0 24 24"
      >
        <path
          stroke="currentColor"
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M12 6v13m0-13 4 4m-4-4-4 4"
        />
      </svg>
    </a>
  </button>
</div>

<!-- update dialog -->
<dialog
  #updateDialog
  class="rounded-2xl border p-6 w-full max-w-md shadow-xl backdrop:bg-black/50 backdrop:backdrop-blur-sm top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 m-0"
>
  <h2 class="text-xl font-semibold mb-4 text-center">Update Blog</h2>
  <form class="flex flex-col gap-4">
    <div class="flex flex-col">
      <label class="text-gray-700 mb-1">Title</label>
      <input
        type="text"
        [(ngModel)]="blogUpdate.title"
        name="title"
        required
        class="border rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-400"
      />
    </div>

    <div class="flex flex-col">
      <label class="text-gray-700 mb-1">Content</label>
      <textarea
        [(ngModel)]="blogUpdate.content"
        name="content"
        required
        rows="5"
        class="border rounded-md text-black px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-400"
      ></textarea>
    </div>

    <div class="flex justify-between gap-2 mt-2">
      <button
        (click)="updateBlog()"
        class="bg-blue-500 text-white px-5 py-2 rounded-lg hover:bg-blue-600 w-full sm:w-auto transition-colors"
      >
        Save
      </button>
      <button
        (click)="closeUpdateDialog()"
        type="button"
        class="bg-gray-300 text-gray-800 px-5 py-2 rounded-lg hover:bg-gray-400 w-full sm:w-auto transition-colors"
      >
        Cancel
      </button>
    </div>
  </form>
</dialog>
